{"version":3,"sources":["../../src/helpers/proxyChain.test.js"],"names":["Keyboard","constructor","_value","value","Mouse","Page","keyboard","mouse","pageValue","Fake","page","bar","ForTest","_evaluateResult","_handleContinueFunc","target","property","args","_handleFunc","echo","text","dummy","getValue","number","f1","f2","f3","f4","fake","withArgs","throwError","Error","describe","it","obj","end","then","expect","toEqual","catch","result","e","v","chainedTarget","keyboardValue","f1Value","withArgsValue"],"mappings":"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","file":"proxyChain.test.js","sourcesContent":["import { isFunc, handleAsyncFunc } from './functions';\r\nimport chain from './proxyChain';\r\n\r\nclass Keyboard {\r\n  constructor() {\r\n    this._value = 'keyboard';\r\n  }\r\n\r\n  value() {\r\n    return this._value;\r\n  }\r\n}\r\n\r\nclass Mouse {\r\n  constructor() {\r\n    this._value = 'mouse';\r\n  }\r\n\r\n  async value() {\r\n    return this._value;\r\n  }\r\n}\r\n\r\nclass Page {\r\n  constructor() {\r\n    this.keyboard = new Keyboard();\r\n    this.mouse = new Mouse();\r\n  }\r\n\r\n  // eslint-disable-next-line class-methods-use-this\r\n  value() {\r\n    return 'Page';\r\n  }\r\n\r\n  async pageValue() {\r\n    return this.value();\r\n  }\r\n}\r\n\r\nclass Fake {\r\n  constructor(value) {\r\n    this._value = value;\r\n    this.page = new Page();\r\n  }\r\n\r\n  async bar() {\r\n    this._value += '4';\r\n    return this._value;\r\n  }\r\n}\r\n\r\nclass ForTest {\r\n  constructor() {\r\n    this._value = '';\r\n    this.page = new Page();\r\n  }\r\n\r\n  value() {\r\n    return this._value;\r\n  }\r\n\r\n  async pageValue() {\r\n    return this.page.pageValue();\r\n  }\r\n\r\n  _evaluateResult() { return this._value; }\r\n\r\n  // eslint-disable-next-line class-methods-use-this\r\n  async _handleContinueFunc(target, property, args) {\r\n    return isFunc(target[property]) ? target[property](...args) : target[property];\r\n  }\r\n\r\n  _handleFunc(target, property, args) {\r\n    if (target === 'page') {\r\n      if (this[property]) {\r\n        return isFunc(this[property]) ? handleAsyncFunc(this, property, args) : this[property];\r\n      }\r\n      return isFunc(this.page[property]) ? handleAsyncFunc(this.page, property, args) : this.page[property];\r\n    }\r\n    return isFunc(this.page[target][property])\r\n      ? handleAsyncFunc(this.page[target], property, args)\r\n      : this.page[target][property];\r\n  }\r\n\r\n  async echo(text) {\r\n    this.dummy = null;\r\n    return text;\r\n  }\r\n\r\n  getValue(number) { this._value += number; return this._value; }\r\n\r\n  f1() {\r\n    return this.getValue('1');\r\n  }\r\n\r\n  f2() {\r\n    return this.getValue('2');\r\n  }\r\n\r\n  f3() {\r\n    return this.getValue('3');\r\n  }\r\n\r\n  f4() {\r\n    const fake = new Fake(this._value);\r\n    return fake;\r\n  }\r\n\r\n  withArgs(args) {\r\n    return this.getValue(args);\r\n  }\r\n\r\n  async throwError() {\r\n    this.dummy = null;\r\n    throw new Error('error');\r\n  }\r\n}\r\n\r\ndescribe('chainProxy', () => {\r\n  it('add chain interface', async () => {\r\n    const obj = chain(new ForTest());\r\n    await obj\r\n      .f1()\r\n      .f2()\r\n      .f3()\r\n      .value()\r\n      .end()\r\n      .then((value) => {\r\n        expect(value).toEqual('123');\r\n      });\r\n  });\r\n  it('add chain interface.(reverse)', async () => {\r\n    const obj = chain(new ForTest());\r\n    await obj\r\n      .f3()\r\n      .f2()\r\n      .f1()\r\n      .value()\r\n      .end()\r\n      .then((value) => {\r\n        expect(value).toEqual('321');\r\n      });\r\n  });\r\n  it('removes all actions if occurred an exception.', async () => {\r\n    const obj = chain(new ForTest());\r\n    await obj\r\n      .f1()\r\n      .throwError()\r\n      .f2()\r\n      .end()\r\n      .then(() => {\r\n        throw (new Error('error'));\r\n      })\r\n      .catch(() => {\r\n        obj\r\n          .f3()\r\n          .end()\r\n          .then((result) => {\r\n            expect(result).toEqual('13');\r\n          })\r\n          .catch((e) => {\r\n            throw (e);\r\n          });\r\n      });\r\n  });\r\n  describe('#result', () => {\r\n    it('receive last return value', async () => {\r\n      const obj = chain(new ForTest());\r\n      let result = null;\r\n      await obj\r\n        .echo('AAA')\r\n        .result((v) => { result = v; })\r\n        .end()\r\n        .then(() => {\r\n          expect(result).toEqual('AAA');\r\n        });\r\n    });\r\n    it('result function', async () => {\r\n      const obj = chain(new ForTest());\r\n      let result = null;\r\n      await obj\r\n        .echo('AAA')\r\n        .result((v) => { result = v; })\r\n        .end()\r\n        .then(() => {\r\n          expect(result).toEqual('AAA');\r\n        });\r\n    });\r\n  });\r\n  describe('#then', () => {\r\n    it('continues to current target.', async () => {\r\n      const target = new ForTest();\r\n      const obj = chain(target);\r\n      target.chainedTarget = obj;\r\n      await obj\r\n        .f1()\r\n        .f4()\r\n        .then\r\n        .bar()\r\n        .end()\r\n        .then((result) => {\r\n          expect(result).toEqual('14');\r\n        });\r\n    });\r\n    it('will switch to main target after continues to current target.', async () => {\r\n      const target = new ForTest();\r\n      const obj = chain(target);\r\n      target.chainedTarget = obj;\r\n      await obj\r\n        .f1()\r\n        .f4()\r\n        .then\r\n        .bar()\r\n        .f2()\r\n        .end()\r\n        .then((result) => {\r\n          expect(result).toEqual('12');\r\n        });\r\n    });\r\n  });\r\n  describe('subModules', () => {\r\n    it('continues to current target.', async () => {\r\n      const target = new ForTest();\r\n      const obj = chain(target);\r\n      target.chainedTarget = obj;\r\n      await obj\r\n        .f1()\r\n        .f4()\r\n        .keyboard\r\n        .value()\r\n        .end()\r\n        .then((result) => {\r\n          expect(result).toEqual('keyboard');\r\n        });\r\n    });\r\n    it('continues to another target.', async () => {\r\n      const target = new ForTest();\r\n      const obj = chain(target);\r\n      target.chainedTarget = obj;\r\n      await obj\r\n        .f1()\r\n        .keyboard\r\n        .value()\r\n        .page\r\n        .f4()\r\n        .then\r\n        .bar()\r\n        .mouse\r\n        .value()\r\n        .end()\r\n        .then((result) => {\r\n          expect(result).toEqual('mouse');\r\n        });\r\n    });\r\n    it('continues to another target and get result.', async () => {\r\n      const target = new ForTest();\r\n      const obj = chain(target);\r\n      target.chainedTarget = obj;\r\n      await obj\r\n        .f1()\r\n        .keyboard\r\n        .value()\r\n        .page\r\n        .f4()\r\n        .then\r\n        .bar()\r\n        .result((result) => { expect(result).toEqual('14'); })\r\n        .mouse\r\n        .value()\r\n        .end()\r\n        .then((result) => {\r\n          expect(result).toEqual('mouse');\r\n        });\r\n    });\r\n  });\r\n  describe('unchained', () => {\r\n    it('will work unchained', async () => {\r\n      const obj = chain(new ForTest(), false);\r\n      const value = await obj.f1();\r\n      expect(value).toEqual('1');\r\n    });\r\n    it('will work with complex scenarios', async () => {\r\n      const obj = chain(new ForTest(), false);\r\n      const value = await obj.f1();\r\n      const keyboardValue = await obj.keyboard.value();\r\n      expect(value).toEqual('1');\r\n      expect(keyboardValue).toEqual('keyboard');\r\n    });\r\n    it('will work with calling async function', async () => {\r\n      const obj = chain(new ForTest(), false);\r\n      const f1Value = await obj.f1();\r\n      const pageValue = await obj.pageValue();\r\n      expect(f1Value).toEqual('1');\r\n      expect(pageValue).toEqual('Page');\r\n    });\r\n    it('will pass the right arguments', async () => {\r\n      const obj = chain(new ForTest(), false);\r\n      const withArgsValue = await obj.withArgs('param');\r\n      expect(withArgsValue).toEqual('param');\r\n    });\r\n  });\r\n});\r\n"]}